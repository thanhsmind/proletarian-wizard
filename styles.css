/* --- Biến màu được tinh chỉnh để rõ ràng hơn --- */
:root {
  --background-color: #1a1a1a; /* Nền tối hơn một chút */
  --item-hover-background-color: #2c2c2c;
  --primary-text-color: #f0f0f0; /* Màu chữ chính, sáng và rõ hơn */
  --secondary-text-color: #a0a0a0; /* Màu chữ phụ, thông tin meta */
  --completed-text-color: #888888; /* Màu chữ khi đã hoàn thành */
  --checkbox-border-color: #8e8e93;
  --checkbox-checked-color: #5e97f6; /* Màu xanh dương cho checkbox */
  --date-overdue-color: #ff8a80; /* Màu đỏ cho ngày quá hạn */
  --separator-color: #333333; /* Màu đường kẻ phân cách */
}

body {
  background-color: var(--background-color);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
    Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
  color: var(--primary-text-color);
}

/* --- Container chính của mỗi mục To-do --- */
.pw-todo-container {
  display: flex;
  align-items: center; /* Đổi thành 'center' để checkbox, text, icon thẳng hàng đẹp hơn */
  gap: 8px; /* Dùng 'gap' để tạo khoảng cách đều giữa các item, thay cho margin riêng lẻ */
  width: 100%;
  cursor: pointer;
  transition: background-color 0.2s ease-in-out;
  border-bottom: 1px solid var(--separator-color); /* Đường kẻ phân cách */
}
.pw-todo-container:has(> .pw-todo-sub-container) {
  flex-wrap: wrap;
  align-items: flex-start;
}
.pw-todo-container:hover {
  background-color: var(--item-hover-background-color);
}
.pw-planning-column-content > div > .pw-todo-container {
  margin-bottom: 16px; /* Bạn có thể điều chỉnh giá trị này để có khoảng cách mong muốn */
}

/* === TRẠNG THÁI KHI HOÀN THÀNH (Sử dụng class .checked) === */
/* === TRẠNG THÁI HOÀN THÀNH VỚI ICON 🟢 MỚI === */

/* 1. Khi checkbox được check, ẩn nội dung gốc và bỏ màu nền/viền */
.pw-todo-checkbox.checked {
  font-size: 0; /* Ẩn icon/text gốc bên trong */
  background-color: transparent; /* Bỏ màu nền xanh dương */
  border-color: transparent; /* Bỏ viền xanh dương */
  /* Giữ lại thuộc tính display flex để căn giữa icon mới */
  display: flex;
  align-items: center;
  justify-content: center;
}

/* 2. Bỏ đi dấu tick cũ được vẽ bằng CSS */
.pw-todo-checkbox.checked::after {
  content: none; /* Xóa bỏ dấu tick cũ */
}

/* 3. Thêm icon 🟢 mới bằng pseudo-element ::before */
.pw-todo-checkbox.checked::before {
  content: "🟢";
  font-size: 16px; /* Đặt lại kích thước font để icon hiển thị. Bạn có thể điều chỉnh kích thước này. */
  line-height: 1; /* Đảm bảo icon được căn giữa tốt hơn */
}

/* 4. Đừng quên style cho phần text bị gạch ngang */
.pw-todo-checkbox.checked + .pw-todo-text {
  color: var(--completed-text-color);
  text-decoration: line-through;
}

/* (Tùy chọn) Style cho meta nếu có */
.pw-todo-checkbox.checked ~ .pw-todo-meta {
  text-decoration: line-through;
}
/* --- Checkbox --- */
.pw-todo-checkbox {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 20px;
  height: 20px;
  border: 2px solid var(--checkbox-border-color);
  border-radius: 50%;
  font-size: 0;
  transition: all 0.2s;
  position: relative;
  top: 0px;
}

/* --- Nội dung (Text + Meta) --- */
.pw-todo-content {
  flex-grow: 1; /* Để nội dung chiếm hết không gian còn lại */
}

.pw-todo-text {
  flex: 1 1 0; /* Tương đương: flex-grow: 1, flex-shrink: 1, flex-basis: 0 */
  min-width: 0; /* << RẤT QUAN TRỌNG: Cho phép flex item co lại nhỏ hơn cả nội dung của nó */
  transition: color 0.2s ease-in-out;
}

/* --- Thông tin phụ (ngày tháng,...) --- */
.pw-todo-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  color: var(--secondary-text-color);
}

.pw-todo-meta .overdue {
  color: var(--date-overdue-color);
}

/* --- Khu vực hành động bên phải --- */
.pw-todo-actions {
  font-size: 13px;
  color: var(--secondary-text-color);
}

/* === TRẠNG THÁI KHI HOÀN THÀNH === */
.pw-todo-container.completed .pw-todo-text {
  color: var(--completed-text-color);
  text-decoration: line-through;
}

.pw-todo-container.completed .pw-todo-meta {
  text-decoration: line-through;
}

.pw-todo-container.completed .pw-todo-checkbox {
  background-color: var(--checkbox-checked-color);
  border-color: var(--checkbox-checked-color);
}

.pw-todo-container.completed .pw-todo-checkbox::after {
  content: "";
  display: block;
  width: 5px;
  height: 10px;
  border: solid white;
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
}

/* Target vào class của bạn */
.pw-planning-column--today .pw-planning-column-title-icon {
  /* Ẩn ký tự gốc bên trong thẻ span bằng cách cho font-size bằng 0 */
  font-size: 0;
}

/* Tạo một element giả ngay trước nội dung gốc (đã bị ẩn) */
.pw-planning-today
  .pw-planning-column--today:nth-of-type(1)
  .pw-planning-column-title-icon::before {
  /* Thêm icon mới của bạn vào đây */
  content: "🔴";

  /* Đặt lại kích thước font cho icon mới để nó hiển thị */
  font-size: 16px; /* <-- Bạn có thể điều chỉnh kích thước ở đây */
}
.pw-planning-today
  .pw-planning-column--today:nth-of-type(2)
  .pw-planning-column-title-icon::before {
  /* Thêm icon mới của bạn vào đây */
  content: "🟡";

  /* Đặt lại kích thước font cho icon mới để nó hiển thị */
  font-size: 16px; /* <-- Bạn có thể điều chỉnh kích thước ở đây */
}
.pw-planning-today
  .pw-planning-column--today:nth-of-type(3)
  .pw-planning-column-title-icon::before {
  /* Thêm icon mới của bạn vào đây */
  content: "🟢";

  /* Đặt lại kích thước font cho icon mới để nó hiển thị */
  font-size: 16px; /* <-- Bạn có thể điều chỉnh kích thước ở đây */
}

.HyperMD-task-line {
  color: var(--color-purple);
}

.pw-todo-text-complete {
  text-decoration: line-through;
  display: inline-block;
}

.pw-todo-checkbox {
  /* height: 100%; */
  display: inline-block;
  width: 20px;
}

.pw-todo-text {
  display: inline;
}

.pw-todo-panel {
  font-size: small;
}

.pw-todo-duration {
  font-style: italic;
  color: var(--text-muted);
}

.pw-todo-container {
  cursor: pointer;
  /* display: inline; */
  flex-direction: row;
  transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
}

.pw-todo-container:hover {
  border-color: transparent;
  background-color: transparent;
}
.todo-sub {
  flex-shrink: 0;
}
.pw-todo-sub-container {
  flex-basis: 100%;
  margin-top: 8px;
  margin-left: 8px;
  padding-left: 15px;
  border-left: 1px solid var(--separator-color, #333333);
}

.pw-planning-subsection-title {
  font-weight: bold;
  padding: 2px 0;
  margin-bottom: 5px;
  color: var(--text-accent);
  border-bottom: 1px solid var(--background-modifier-border);
}

.pw-planning-subsection-divider {
  border-top: 1px dashed var(--background-modifier-border);
  margin: 10px 0;
}

.pw-planning--settings {
  display: block;
}

.ub-color_474d66 {
  color: var(--text-normal) !important;
}

.pw-planning--settings--search {
  display: inline-block;
  margin-left: 20px;
}

.pw-planning--settings--wip {
  display: inline-block;
  margin-left: 20px;
}

.pw-planning--settings--hide-checkbox {
  display: inline-block;
}

.pw-planning-column {
  width: 260px;
  margin: 5px;
  display: inline-block;
  height: 260px;
}

.pw-planning-column-title {
  width: 100%;
  margin-bottom: 15px;
  font-weight: bold;
  text-align: center;
}

.pw-planning-column-title-icon {
  margin-right: 10px;
}

.pw-planning-column-content {
  padding: 8px;
  font-size: 0.8em;
  border: 1px solid var(--background-modifier-border);
  height: 100%;
  overflow: auto;
  border-radius: 10px;
}

/* TODAY */

.pw-planning-today {
  border: 3px solid var(--background-modifier-border);
  border-radius: 10px;
  padding: 10px;
  margin-bottom: 30px;
}

.pw-planning-today h1 {
  text-align: center;
  padding-bottom: 15px;
}

.pw-planning-today-icon {
  color: #fc0;
}

.pw-planning-column--today {
  width: 30%;
}

.pw-planning-column--today:nth-of-type(1) {
  border-right: 1px solid var(--background-modifier-border);
}

.pw-planning-column--today:nth-of-type(3) {
  border-left: 1px solid var(--background-modifier-border);
}

.pw-planning-column-content--today {
  border: 1px solid transparent;
}

.pw-planning-column-content--hover {
  border-color: var(--background-modifier-border-hover);
  background-color: var(--background-modifier-hover);
}

.pw-planning-column-content--wip-exceeded {
  border: 1px solid var(--text-error);
}

.pw-report {
  overflow: auto;
  padding: 10px;
}

.pw-report-container {
  padding: 30px;
  margin: 10px;
  border: 1px solid var(--background-modifier-border);
  border-radius: var(--radius-m);
  min-height: 80px;
}

.pw-error {
  color: var(--background-modifier-error);
}

.pw-tag-pill {
  background-color: var(--background-modifier-hover);
  color: var(--text-muted);
  padding: 2px 5px;
  border-radius: 10px;
  margin-right: 5px;
}

/* Date Time Progress Bar Styles */
.pw-date-time-header {
  position: relative;
  overflow: hidden;
  border-radius: 4px;
  margin-bottom: 10px;
  text-align: center;
}

.pw-progress-container {
  margin: auto;
  width: 400px;
  height: 10px;
  background-color: var(--background-secondary);
  border: 1pt solid var(--interactive-accent);
  z-index: 0;
}

.pw-progress-bar {
  height: 100%;
  background-color: var(--interactive-accent);
  opacity: 0.5;
  transition: width 0.5s ease;
  z-index: 1;
}

.pw-current-date-time {
  color: var(--text-normal);
  font-size: 1.2em;
  position: relative;
  z-index: 2;
  margin: 10px auto;
  display: flex;
  justify-content: center;
  align-items: center;
}

.pw-current-date-time-icon {
  margin-right: 8px;
}

/* Fixed width for time to prevent shifting */
.pw-time-dynamic {
  display: inline-block;
  min-width: 110px;
  text-align: left;
}

.pw-time-separator {
  display: inline-block;
  width: 15px;
  text-align: center;
}

.pw-today-hours-container {
  margin-top: 20px;
  padding: 10px;
  border-top: 1px solid var(--background-modifier-border);
}

.pw-today-hours-input {
  display: flex;
  align-items: center;
  gap: 8px;
}

.pw-today-hours-reset {
  margin-left: auto;
}

/* Ignored Folders Settings UI */
.pw-ignored-folders-section {
  margin-bottom: 20px;
}

.pw-ignored-folders-list {
  margin-top: 10px;
  margin-left: 40px;
}

.pw-no-ignored-folders {
  color: var(--text-muted);
  font-style: italic;
  margin-top: 5px;
}

.pw-ignored-folders-items {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.pw-ignored-folder-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 5px 10px;
  margin-bottom: 5px;
  background-color: var(--background-secondary);
  border-radius: 4px;
}

.pw-ignored-folder-name {
  flex-grow: 1;
  margin-right: 10px;
}

/* Folder Selection Modal */
.pw-folder-selection-list {
  max-height: 300px;
  overflow-y: auto;
  margin-top: 15px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
}

.pw-folder-search-container {
  margin-bottom: 10px;
}

.pw-folder-search-input {
  width: 100%;
  padding: 8px;
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
}

.pw-folder-list {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.pw-folder-list-item {
  padding: 2px 0;
}

.pw-folder-select-button {
  display: block;
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  background: transparent;
  border: none;
  border-radius: 0;
  color: var(--text-normal);
  cursor: pointer;
}

.pw-folder-select-button:hover {
  background-color: var(--background-modifier-hover);
}

/* Report Header and Export Button Styles */
.pw-report-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.pw-report-actions {
  margin: 15px 0;
  text-align: right;
}

.pw-report-export-button {
  background-color: var(--interactive-accent);
  color: var(--text-on-accent);
  padding: 6px 12px;
  border-radius: 4px;
  cursor: pointer;
  font-weight: 500;
  border: none;
}

.pw-report-export-button:hover {
  background-color: var(--interactive-accent-hover);
}

/* Export Modal Styling */
.pw-tag-selection {
  max-height: 200px;
  overflow-y: auto;
  margin: 10px 0;
  padding: 5px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
}

.pw-tag-selection .setting-item {
  padding: 6px;
  border-top: none;
}

.pw-tag-selection .setting-item:hover {
  background-color: var(--background-modifier-hover);
}

.pw-export-modal h2 {
  margin-bottom: 20px;
  text-align: center;
  color: var(--text-accent);
}

.pw-export-modal h3 {
  margin: 10px 0;
  color: var(--text-normal);
  font-size: 1rem;
  border-bottom: 1px solid var(--background-modifier-border);
  padding-bottom: 5px;
}

/* Clickable column titles */
.pw-planning-column-title--clickable {
  cursor: pointer;
  transition: background-color 0.2s ease;
  padding: 4px 8px;
  border-radius: 4px;
}

.pw-planning-column-title--clickable:hover {
  background-color: var(--background-modifier-hover);
}

/* Clickable Today title */
.pw-planning-today-title--clickable {
  cursor: pointer;
  transition: background-color 0.2s ease;
  padding: 4px 8px;
  border-radius: 4px;
  margin: 0;
}

.pw-planning-today-title--clickable:hover {
  background-color: var(--background-modifier-hover);
}

/* Date selection modal */
.pw-date-selection-container {
  display: flex;
  flex-direction: column;
  gap: 5px;
  max-height: 300px;
  overflow-y: auto;
  margin: 15px 0;
}

.pw-date-selection-button {
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  background: transparent;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  color: var(--text-normal);
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.pw-date-selection-button:hover {
  background-color: var(--background-modifier-hover);
}

.pw-date-selected {
  background-color: var(--interactive-accent);
  color: var(--text-on-accent);
  border-color: var(--interactive-accent);
}

/* --- Tối ưu hóa giao diện Mobile cho khu vực Today --- */
@media screen and (max-width: 768px) {
  .pw-planning-column-title {
    text-align: left;
    padding-left: 10px; /* Thêm một chút đệm để không bị dính sát lề */
  }
  /* 1. Biến container chính thành flexbox dọc để các cột xếp chồng lên nhau */
  .pw-planning-today {
    display: flex;
    flex-direction: column;
    gap: 20px; /* Thêm khoảng cách giữa các cột khi xếp chồng */
    border: none; /* Bỏ border bên ngoài cho gọn hơn trên mobile */
    padding: 5px;
  }

  /* --- A. STYLE CHO MÀN HÌNH LỚN (DESKTOP) --- */
  /* Các cột Backlog, Past... sẽ hiển thị ngang nhau */
  .pw-planning-nextaction .pw-planning-column {
    display: inline-block;
    width: 260px; /* Chiều rộng cố định trên desktop */
    height: 260px; /* Chiều cao cố định */
    margin: 10px;
    vertical-align: top;
  }

  /* Style cho container .pw-planning-nextaction trên desktop */
  .pw-planning-nextaction {
    margin-top: 30px;
    text-align: center; /* Căn giữa các cột inline-block */
  }

  /* --- B. STYLE GHI ĐÈ CHO MÀN HÌNH NHỎ (MOBILE) --- */
  @media screen and (max-width: 768px) {
    /* ... (giữ lại tất cả các style mobile cũ của bạn cho khu vực Today) ... */

    .pw-planning-today {
      display: flex;
      flex-direction: column;
      gap: 20px;
      border: none;
      padding: 5px;
    }

    .pw-planning-column--today {
      width: 100%;
      margin: 0;
      height: auto;
      border: 1px solid var(--separator-color);
      border-radius: 8px;
      padding-bottom: 10px;
    }

    .pw-planning-column-title {
      text-align: left;
      padding-left: 10px;
    }

    /* === PHẦN MỚI THÊM VÀO === */
    /* Các cột Backlog, Past... sẽ xếp chồng và chiếm toàn bộ chiều rộng */
    .pw-planning-nextaction .pw-planning-column {
      display: block;
      width: 100%; /* Chiếm toàn bộ chiều rộng trên mobile */
      height: auto; /* Chiều cao tự động theo nội dung */
      min-height: 100px; /* Chiều cao tối thiểu để không bị xẹp */
      margin: 0 0 20px 0; /* Chỉ giữ lại margin dưới để tạo khoảng cách */
    }

    /* Căn lề lại cho container trên mobile */
    .pw-planning-nextaction {
      text-align: left;
      margin-top: 20px;
    }
  }

  /* 2. Thiết lập lại các cột để hiển thị dạng list item */
  .pw-planning-column--today {
    width: 100%; /* Chiếm toàn bộ chiều rộng */
    margin: 0; /* Xóa margin cũ */
    height: auto; /* Để chiều cao tự động theo nội dung */
    border: 1px solid var(--separator-color); /* Thêm border cho mỗi mục */
    border-radius: 8px; /* Bo góc cho đẹp */
  }

  /* 3. Sắp xếp lại thứ tự các cột bằng thuộc tính `order` của flexbox */

  /* Cột "In progress" (cột thứ 2 trong HTML) lên đầu tiên */
  .pw-planning-today .pw-planning-column--today:nth-of-type(2) {
    order: 1;
  }

  /* Cột "Todo" (cột thứ 1 trong HTML) xuống thứ hai */
  .pw-planning-today .pw-planning-column--today:nth-of-type(1) {
    order: 2;
  }

  /* Cột "Done" (cột thứ 3 trong HTML) ở cuối cùng */
  .pw-planning-today .pw-planning-column--today:nth-of-type(3) {
    order: 3;
  }

  /* 4. Xóa bỏ các đường viền ngăn cách dọc không cần thiết nữa */
  .pw-planning-column--today:nth-of-type(1),
  .pw-planning-column--today:nth-of-type(3) {
    border-right: none;
    border-left: none;
  }
}
